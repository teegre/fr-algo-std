#! /usr/bin/env fralgo

Importer "src/datelib" Alias date

Variable ts en Entier
Variable i en Entier
Variable l en Entier

ProcÃ©dure VÃ©rifier(horodatage en NumÃ©rique, attendu en ChaÃ®ne)
  Variable obtenu en ChaÃ®ne
  obtenu â† date:Format(horodatage, "%a %F %T %z %Z %j %V")

  Si obtenu <> attendu Alors
    Ecrire "âŒ Ã‰chec : ", horodatage
    Ecrire "# obtenu  :", obtenu
    Ecrire "# attendu :", attendu
  Sinon
    Ecrire "âœ… OK : ", obtenu
  FinSi
FinProcÃ©dure

DÃ©but
  Ecrire "#################################################################"
  Ecrire "# Tests des fonctions 'datelib:UNIXversLocal' et 'datelib:Format'"
  Ecrire "#################################################################"
  Ecrire ""

  # Cas fixes
  VÃ©rifier(-3600,      "jeu. 01/01/1970 00:00:00 +0100 CET 001 01")
  VÃ©rifier(978303600,  "lun. 01/01/2001 00:00:00 +0100 CET 001 01")
  VÃ©rifier(-315622800, "ven. 01/01/1960 00:00:00 +0100 CET 001 53")
  VÃ©rifier(4102441200, "ven. 01/01/2100 00:00:00 +0100 CET 001 53")
  VÃ©rifier(915145200,  "ven. 01/01/1999 00:00:00 +0100 CET 001 53")
  VÃ©rifier(951692400,  "lun. 28/02/2000 00:00:00 +0100 CET 059 09") # AnnÃ©e bissextile

  Ecrire ""

  # Tests alÃ©atoires
  Pour i â† 1 Ã  10
    ts â† Entier(AlÃ©a() * 5000000000 - 1000000000)
    l â† Longueur(ChaÃ®ne(ts))
    Ecrire "ğŸ”„ Test avec", ts, std:RemplirGauche("=>", " ", 10+2-l), date:Format(NumÃ©rique(ts), "%a %F %T %z %Z %j %V")
  i Suivant
Fin
